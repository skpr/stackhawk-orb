description: >
  The following example shows a typical dev, stg, prod deployment workflow, running pre and post-deployment steps in the env.

usage:
  version: 2.1
  orbs:
    skpr: skpr/stackhawk@1.0.0
  commands:
    skpr-pre-deploy:
      parameters:
        env:
          type: string
      steps:
        - run:
            name: Skpr Pre-Deploy
            command: skpr exec << parameters.env >> -- make deploy-prepare
    skpr-post-deploy:
      parameters:
        env:
          type: string
      steps:
        - run:
            name: Skpr Post-Deploy
            command: skpr exec << parameters.env >> -- make deploy
  workflows:
    deploy:
      jobs:
        - stackhawk/configure:
            name: Configure StackHawk
            app_id: ${STACKHAWK_APP_ID}
            env: ${STACKHAWK_ENV}
            host: ${STACKHAWK_HOST}

        - stackhawk/scan:
            name: Run StackHawk
            context: skpr-example
            api_key: ${STACKHAWK_API_KEY}